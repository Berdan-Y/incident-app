<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:Maui.ViewModels"
             xmlns:converters="clr-namespace:Maui.Converters"
             xmlns:behaviors="clr-namespace:Maui.Behaviors"
             xmlns:maps="clr-namespace:Microsoft.Maui.Controls.Maps;assembly=Microsoft.Maui.Controls.Maps"
             x:Class="Maui.Pages.ReportIncidentPage"
             x:DataType="viewmodels:ReportIncidentViewModel">

    <ScrollView>
        <Grid RowDefinitions="Auto,Auto,Auto,*"
              Padding="20">
            <VerticalStackLayout Grid.Row="0"
                                Spacing="5">
                <Label Text="Report Incident"
                       FontSize="32"
                       HorizontalOptions="Center"
                       Margin="0,0,0,15" />

                <Entry Text="{Binding Title}"
                       Placeholder="Title" 
                       Margin="0,0,0,15" />

                <Entry Text="{Binding Description}"
                       Placeholder="Description"
                       Margin="0,10,0,0" />

                <Label Text="Location Settings"
                       FontSize="18"
                       Margin="0,20,0,10"/>

                <RadioButton Content="Use Current Location"
                            IsChecked="{Binding UseCurrentLocation}"
                            GroupName="LocationChoice"/>

                <RadioButton Content="Set Location Manually"
                            IsChecked="{Binding UseManualLocation}"
                            GroupName="LocationChoice"/>
            </VerticalStackLayout>

            <maps:Map Grid.Row="1"
                      x:Name="LocationMap"
                      IsVisible="{Binding ShowMap}"
                      IsShowingUser="True"
                      ItemsSource="{Binding MapPins}"
                      MapType="Street"
                      Loaded="OnMapLoaded"
                      Margin="0,10,0,10"
                      HeightRequest="200"/>

            <Label Grid.Row="2"
                   Text="{Binding LocationStatus}"
                   IsVisible="{Binding UseCurrentLocation}"
                   HorizontalOptions="Center"
                   Margin="0,5,0,10"
                   TextColor="{OnPlatform iOS='#007AFF', Android='#512BD4'}"
                   FontSize="14"/>

            <VerticalStackLayout Grid.Row="3"
                                Spacing="5">
                <VerticalStackLayout IsVisible="{Binding UseManualLocation}"
                                   Spacing="5"
                                   Margin="0,10,0,0">
                    <Entry Text="{Binding Address}"
                           Placeholder="Address"/>
                    <Entry Text="{Binding Zipcode}"
                           Placeholder="Zipcode"
                           Margin="0,10,0,0"/>
                </VerticalStackLayout>

                <Button Text="Submit Report"
                        Command="{Binding SubmitReportCommand}"
                        IsEnabled="{Binding IsNotLoading}"
                        Margin="0,20,0,0" />

                <ActivityIndicator IsRunning="{Binding IsLoading}"
                                 IsVisible="{Binding IsLoading}"
                                 HorizontalOptions="Center" />
            </VerticalStackLayout>
        </Grid>
    </ScrollView>

</ContentPage> 